{"version":3,"file":"js/8561.6e5f13d6.js","mappings":"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","sources":["webpack://@radiantearth/stac-browser/./src/views/Search.vue","webpack://@radiantearth/stac-browser/src/views/Search.vue","webpack://@radiantearth/stac-browser/./src/views/Search.vue?a8fc","webpack://@radiantearth/stac-browser/./src/views/Search.vue?1f58"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('main',{staticClass:\"search d-flex flex-column\"},[(!_vm.parent)?_c('Loading',{attrs:{\"stretch\":\"\"}}):(!_vm.searchLink)?_c('b-alert',{attrs:{\"variant\":\"danger\",\"show\":\"\"}},[_vm._v(_vm._s(_vm.$t('search.notSupported')))]):_c('b-row',[_c('b-col',{staticClass:\"left\"},[_c('ItemFilter',{attrs:{\"stac\":_vm.parent,\"title\":\"\",\"value\":_vm.filters,\"type\":\"Global\"},on:{\"input\":_vm.setFilters}})],1),_c('b-col',{staticClass:\"right\"},[(_vm.loading)?_c('Loading',{attrs:{\"fill\":\"\",\"top\":\"\"}}):(!_vm.hasItems && !_vm.hasFilters)?_c('b-alert',{attrs:{\"variant\":\"info\",\"show\":\"\"}},[_vm._v(_vm._s(_vm.$t('search.modifyCriteria')))]):(!_vm.hasItems)?_c('b-alert',{attrs:{\"variant\":\"warning\",\"show\":\"\"}},[_vm._v(_vm._s(_vm.$t('search.noItemsFound')))]):_vm._e(),(_vm.hasItems)?[_c('div',{attrs:{\"id\":\"search-map\"}},[_c('Map',{attrs:{\"stac\":_vm.parent,\"stacLayerData\":_vm.itemCollection,\"scrollWheelZoom\":\"\",\"popover\":\"\"}})],1),_c('Items',{attrs:{\"stac\":_vm.parent,\"items\":_vm.apiItems,\"api\":true,\"allowFilter\":false,\"pagination\":_vm.itemPages},on:{\"paginate\":_vm.paginateItems}})]:_vm._e()],2)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <main class=\"search d-flex flex-column\">\n    <Loading v-if=\"!parent\" stretch />\n    <b-alert v-else-if=\"!searchLink\" variant=\"danger\" show>{{ $t('search.notSupported') }}</b-alert>\n    <b-row v-else>\n      <b-col class=\"left\">\n        <ItemFilter\n          :stac=\"parent\" title=\"\" :value=\"filters\" type=\"Global\"\n          @input=\"setFilters\"\n        />\n      </b-col>\n      <b-col class=\"right\">\n        <Loading v-if=\"loading\" fill top />\n        <b-alert v-else-if=\"!hasItems && !hasFilters\" variant=\"info\" show>{{ $t('search.modifyCriteria') }}</b-alert>\n        <b-alert v-else-if=\"!hasItems\" variant=\"warning\" show>{{ $t('search.noItemsFound') }}</b-alert>\n        <template v-if=\"hasItems\">\n          <div id=\"search-map\">\n            <Map :stac=\"parent\" :stacLayerData=\"itemCollection\" scrollWheelZoom popover />\n          </div>\n          <Items\n            :stac=\"parent\" :items=\"apiItems\" :api=\"true\" :allowFilter=\"false\"\n            :pagination=\"itemPages\" @paginate=\"paginateItems\"\n          />\n        </template>\n      </b-col>\n    </b-row>\n  </main>\n</template>\n\n<script>\nimport Items from '../components/Items.vue';\nimport { mapGetters, mapMutations, mapState } from \"vuex\";\nimport Utils from '../utils';\nimport ItemFilter from '../components/ItemFilter.vue';\nimport Loading from '../components/Loading.vue';\nimport STAC from '../models/stac';\n\nconst searchId = '__search__';\n\nexport default {\n  name: \"Search\",\n  components: {\n    ItemFilter,\n    Items,\n    Loading,\n    Map: () => import('../components/Map.vue')\n  },\n  props: {\n    loadParent: {\n      type: String,\n      default: null\n    }\n  },\n  data() {\n    return {\n      parent: null,\n      filters: {},\n      selectedItem: null\n    };\n  },\n  computed: {\n    ...mapState(['apiItems', 'apiItemsLink', 'apiItemsPagination', 'catalogUrl', 'catalogTitle']),\n    ...mapGetters(['getStac', 'root', 'collectionLink', 'parentLink', 'fromBrowserPath', 'getApiItemsLoading']),\n    pageTitle() {\n      return this.$t('search.title');\n    },\n    loading() {\n      return this.getApiItemsLoading(searchId);\n    },\n    searchLink() {\n      return this.parent instanceof STAC && this.parent.getSearchLink();\n    },\n    itemCollection() {\n      return {\n        type: 'FeatureCollection',\n        features: this.apiItems,\n        links: []\n      };\n    },\n    itemPages() {\n      let pages = Object.assign({}, this.apiItemsPagination);\n      // If first link is not available, add the items link as first link\n      if (!pages.first && this.data && this.apiItemsLink) {\n        pages.first = Utils.addFiltersToLink(this.apiItemsLink, this.filters);\n      }\n      return pages;\n    },\n    hasFilters() {\n      return Utils.size(this.filters) > 0;\n    },\n    hasItems() {\n      return this.apiItems.length > 0;\n    },\n    pageDescription() {\n      let title = STAC.getDisplayTitle([this.collectionLink, this.parentLink, this.root], this.catalogTitle);\n      return this.$t('search.metaDescription', {title});\n    }\n  },\n  watch:{\n    searchLink: {\n      immediate: true,\n      handler() {\n        if (this.searchLink) {\n          this.showPage();\n        }\n      }\n    }\n  },\n  async created() {\n    let url = this.catalogUrl;\n    if (this.loadParent) {\n      url = this.fromBrowserPath(this.loadParent);\n      this.parent = this.getStac(url);\n    }\n    else {\n      this.parent = this.root;\n    }\n    if (!this.parent) {\n      await this.$store.dispatch('load', { url });\n      if (!this.root) {\n        this.$store.commit(\"config\", { catalogUrl: url });\n      }\n      this.parent = this.getStac(url);\n    }\n  },\n  methods: {\n    ...mapMutations(['toggleApiItemsLoading']),\n    async setFilters(filters, reset = false) {\n      this.filters = filters;\n      if (reset) {\n        this.$store.commit('resetApiItems');\n      }\n      else {\n        await this.filterItems(filters);\n      }\n    },\n    showPage() {\n      this.$store.commit('showPage', {\n        title: this.pageTitle,\n        description: this.pageDescription\n      });\n      this.$store.commit('setApiItemsLink', this.searchLink);\n    },\n    async paginateItems(link) {\n      this.toggleApiItemsLoading(searchId);\n      try {\n        let response = await this.$store.dispatch('loadApiItems', {link, show: true, filters: this.filters});\n        this.handleResponse(response);\n      } catch (error) {\n        this.$root.$emit('error', error, this.$t('errors.loadItems'));\n      } finally {\n        this.toggleApiItemsLoading(searchId);\n      }\n    },\n    async filterItems(filters) {\n      this.toggleApiItemsLoading(searchId);\n      try {\n        let response = await this.$store.dispatch('loadApiItems', {link: this.searchLink, show: true, filters});\n        this.handleResponse(response);\n      } catch(error) {\n        this.$root.$emit('error', error, this.$t('errors.loadFilteredItems'));\n      } finally {\n        this.toggleApiItemsLoading(searchId);\n      }\n    },\n    handleResponse(response) {\n      if (response) {\n        this.$store.commit('showPage', {\n          title: this.pageTitle,\n          url: response.config.url,\n          description: this.pageDescription\n        });\n      }\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import '~bootstrap/scss/mixins';\n@import \"../theme/variables.scss\";\n\n.search {\n  .left {\n    min-width: 200px;\n    flex-basis: 40%;\n  }\n  .right {\n    min-width: 300px;\n    flex-basis: 60%;\n    position: relative !important;\n  }\n  .items {\n    .card-columns {\n      @include media-breakpoint-only(sm) {\n        column-count: 1;\n      }\n      @include media-breakpoint-only(md) {\n        column-count: 1;\n      }\n      @include media-breakpoint-only(lg) {\n        column-count: 2;\n      }\n      @include media-breakpoint-only(xl) {\n        column-count: 2;\n      }\n      @include media-breakpoint-only(xxl) {\n        column-count: 3;\n      }\n      @include media-breakpoint-up(xxxl) {\n        column-count: 4;\n      }\n    }\n  }\n}\n</style>","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Search.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Search.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Search.vue?vue&type=template&id=7e03b515&scoped=true&\"\nimport script from \"./Search.vue?vue&type=script&lang=js&\"\nexport * from \"./Search.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Search.vue?vue&type=style&index=0&id=7e03b515&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7e03b515\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","parent","searchLink","attrs","filters","on","setFilters","loading","hasItems","hasFilters","_e","_v","_s","$t","itemCollection","apiItems","itemPages","paginateItems","staticRenderFns","searchId","name","components","ItemFilter","Items","Loading","Map","props","loadParent","type","String","default","data","selectedItem","computed","mapState","mapGetters","pageTitle","getApiItemsLoading","STAC","getSearchLink","features","links","pages","Object","assign","apiItemsPagination","first","apiItemsLink","Utils","length","pageDescription","title","collectionLink","parentLink","root","catalogTitle","watch","immediate","handler","showPage","url","catalogUrl","fromBrowserPath","getStac","$store","dispatch","commit","methods","mapMutations","reset","filterItems","description","link","toggleApiItemsLoading","response","show","handleResponse","error","$root","$emit","config","component"],"sourceRoot":""}